(()=>{"use strict";(()=>{const e=e=>{const t=document.createElement("button");return t.className=e.className,t.textContent=e.textContent,t.addEventListener("click",e.eventListener),t},t=e=>{const t=document.createElement("div");return t.className=e.className,e.elements.forEach((e=>t.append(e))),t},s=e=>{const t=document.createElement(e.type);return t.className=e.className,t.textContent=e.textContent,t},a=(e,t)=>{const s=document.querySelector("."+e);s&&"textContent"in s&&(s.textContent=t)};let n;const o={totalSec:0,format:"00:00",start:()=>{n=window.setInterval((()=>{l(o)}),1e3)},stop:()=>{clearInterval(n)},clear:()=>{o.totalSec=0,clearInterval(n)}},r=o,l=e=>{e.totalSec+=1;const t=Math.floor(e.totalSec%60),s=Math.floor(e.totalSec/60);e.format=`${c(s)}:${c(t)}`,a("game__time-value",e.format)},c=e=>{const t=String(e);return t.length<2?"0"+t:t},m={amount:0,clear:()=>{m.amount=0}},d=m,i={on:!1,clear:()=>{i.on=!1}},u=i,N=(e,t,s)=>{const n=document.getElementById("blank");if(n){if(_(e,t))[e[t.x][t.y],e[t.x-1][t.y]]=[e[t.x-1][t.y],e[t.x][t.y]],[s.style.top,n.style.top]=[n.style.top,s.style.top];else if(v(e,t))[e[t.x][t.y],e[t.x][t.y-1]]=[e[t.x][t.y-1],e[t.x][t.y]],[s.style.left,n.style.left]=[n.style.left,s.style.left];else if(b(e,t))[e[t.x][t.y],e[t.x][t.y+1]]=[e[t.x][t.y+1],e[t.x][t.y]],[s.style.left,n.style.left]=[n.style.left,s.style.left];else{if(!y(e,t))return;[e[t.x][t.y],e[t.x+1][t.y]]=[e[t.x+1][t.y],e[t.x][t.y]],[s.style.top,n.style.top]=[n.style.top,s.style.top]}if(u.on){const e=document.querySelector(".sound");e&&(e.currentTime=0,e.play())}d.amount+=1,a("game__moves-value",String(d.amount))}},_=(e,t)=>{const{x:s,y:a}=t;return!(s-1<0)&&0===e[s-1][a]},y=(e,t)=>{const{x:s,y:a}=t;return!(s+1>=e.length)&&0===e[s+1][a]},v=(e,t)=>{const{x:s,y:a}=t;return!(a-1<0)&&0===e[s][a-1]},b=(e,t)=>{const{x:s,y:a}=t;return!(a+1>=e[0].length)&&0===e[s][a+1]},p=(e,t)=>((e,t)=>{for(let s=0;s<e.length;s++)for(let a=0;a<e[0].length;a++)if(e[s][a]===t)return{x:s,y:a};return{x:-1,y:-1}})(e,t),x=e=>e%2!=0,g=e=>e%2==0,f=(e,t)=>{const s=e[0].length,a=(n=t).reduce(((e,t)=>e+((e,t)=>{const s=e.indexOf(t);return e.indexOf(0),t-e.slice(0,s+1).reduce(((e,s)=>0!==s&&s<=t?e+1:e),0)})(n,t)),0);var n;const o=h(e);return!!(x(s)&&g(a)||g(s)&&g(o)&&x(a)||g(s)&&x(o)&&g(a))},h=e=>{for(let t=e.length-1;t>=0;t--)for(let s=e[0].length-1;s>=0;s--)if(0===e[t][s])return e.length-t;return-1},L=e=>e.every(((t,s)=>t.every(((t,a)=>0===t?s===e[0].length-1&&a===e[0].length-1:s*e[0].length+(a+1)===t)))),C=e=>{if(e.length<=1)return e;const t=e.slice();for(let e=t.length-1;e>0;e--){const s=Math.floor(Math.random()*(e+1));[t[e],t[s]]=[t[s],t[e]]}return t},z=e=>{if(Math.sqrt(e)%1!=0)return[];const t=[];for(let s=0;s<e;s++)t.push(s);return t},S=e=>{const t=Math.sqrt(e.length);if(t%1!=0)return[[]];const s=[];for(let a=0;a<e.length;a+=t)s.push(e.slice(a,a+t));return s},E={size:3,values:[],generate:()=>{E.values=(e=>{let t=C(z(Math.pow(e,2))),s=S(t);for(;!f(s,t);)t=C(z(Math.pow(e,2))),s=S(t);return s})(E.size)},clear:()=>{E.size=3,E.values=[]}},w=E,k=()=>{const a=document.createElement("div");return a.className="menu",a.append(t({className:a.className+"__content",elements:[s({type:"h2",className:a.className+"__title",textContent:"menu"}),e({className:a.className+"__resume-btn",textContent:"Resume",eventListener:e=>{const t=document.querySelector(".menu"),s=document.querySelector(".blockout");t&&s&&(t.classList.remove("menu_show"),s.classList.remove("blockout_show"),r.start())}}),e({className:a.className+"__restart-btn",textContent:"Restart",eventListener:e=>{document.body.innerHTML="",w.generate(),r.clear(),d.clear(),document.body.append($(),T({size:w.size,board:w.values}),k(),q(),D())}}),e({className:a.className+"__sound-btn",textContent:"Sound: off",eventListener:e=>{u.on?(u.on=!1,e.target.textContent="Sound: off"):(u.on=!0,e.target.textContent="Sound: on")}}),e({className:a.className+"__save-btn",textContent:"Save game",eventListener:e=>{}}),e({className:a.className+"__exit-btn",textContent:"Exit",eventListener:e=>{document.body.innerHTML="",document.body.append(H()),w.clear(),r.clear(),d.clear(),u.clear()}})]})),a},M=(e,t)=>`Hooray! You solved the puzzle in ${e} and ${t} moves.`,q=()=>{const a=document.createElement("div");return a.className="gameover",a.append(t({className:a.className+"__content",elements:[s({type:"h2",className:a.className+"__message",textContent:M("00:00",0)}),e({className:a.className+"__restart-btn",textContent:"Restart",eventListener:e=>{document.body.innerHTML="",w.generate(),r.clear(),d.clear(),document.body.append(T({size:w.size,board:w.values}),k(),q(),D())}}),e({className:a.className+"__exit-btn",textContent:"Exit",eventListener:e=>{document.body.innerHTML="",document.body.append(H()),w.clear(),r.clear(),d.clear()}})]})),a},T=e=>{r.start();const s=document.createElement("div");return s.className="game",s.append(t({className:s.className+"__content",elements:[B({className:s.className+"__info",moves:{className:s.className+"__moves",title:{type:"h2",className:s.className+"__moves-title",textContent:"moves:"},value:{type:"h2",className:s.className+"__moves-value",textContent:"0"}},time:{className:s.className+"__time",title:{type:"h2",className:s.className+"__time-title",textContent:"time:"},value:{type:"h2",className:s.className+"__time-value",textContent:"00:00"}},burger:{className:s.className+"__burger",textContent:"",eventListener:e=>{const t=document.querySelector(".menu"),s=document.querySelector(".blockout");t&&s&&(t.classList.contains("menu_show")?(t.classList.remove("menu_show"),s.classList.remove("blockout_show")):(t.classList.add("menu_show"),s.classList.add("blockout_show"),r.stop()))}}}),I({className:s.className+"__board",board:{size:e.size,grid:e.board,content:{className:s.className+"__board-content"},item:{className:s.className+"__board-item",index:{className:s.className+"__board-item-index"},eventListener:(t,s)=>{if(!s)return;const n=s.childNodes[0].textContent;if(!n)return;const o=p(e.board,parseInt(n));if(N(e.board,o,s),L(e.board)){r.stop(),a("gameover__message",M(r.format,d.amount));const e=document.querySelector(".gameover"),t=document.querySelector(".blockout");if(!e||!t)return;e.classList.add("gameover_show"),t.classList.add("blockout_show")}}}}})]})),s},B=a=>{const n=document.createElement("div");return n.className=a.className,n.append(t({className:a.moves.className,elements:[s(a.moves.title),s(a.moves.value)]}),t({className:a.time.className,elements:[s(a.time.title),s(a.time.value)]}),e(a.burger)),n},I=e=>{const t=document.createElement("div");t.className=e.className;const n=document.createElement("div");n.className=e.board.content.className;const{grid:o}=e.board;for(let t=0;t<o.length;t++)for(let l=0;l<o[0].length;l++){const c=document.createElement("div");c.className=e.board.item.className,c.id="board-"+o[t][l],c.style.width=100/e.board.size+"%",c.style.height=100/e.board.size+"%",c.style.left=(t*e.board.size+l)%e.board.size*(100/e.board.size)+"%",c.style.top=Math.floor((t*e.board.size+l)/e.board.size)*(100/e.board.size)+"%",c.draggable=!0,c.append(s({type:"h2",className:e.board.item.index.className,textContent:String(o[t][l])})),0===o[t][l]?(c.id="blank",c.style.opacity="0",c.addEventListener("drop",(t=>{if(t.preventDefault(),!t||!t.dataTransfer)return;const s=parseInt(t.dataTransfer.getData("text")),n=p(e.board.grid,s),o=document.getElementById("board-"+s);if(o&&(N(e.board.grid,n,o),L(e.board.grid))){r.stop(),a("gameover__message",M(r.format,d.amount));const e=document.querySelector(".gameover"),t=document.querySelector(".blockout");if(!e||!t)return;e.classList.add("gameover_show"),t.classList.add("blockout_show")}})),c.addEventListener("dragover",(e=>{e.preventDefault()}))):(c.addEventListener("click",(t=>e.board.item.eventListener(t,c))),c.addEventListener("dragstart",(e=>{e&&e.dataTransfer&&c.textContent&&e.dataTransfer.setData("text",c.textContent)}))),n.append(c)}return t.append(n),t},H=()=>{const n=document.createElement("div");return n.className="main",n.append(t({className:n.className+"__content",elements:[s({type:"h2",className:n.className+"__title",textContent:"gem-puzzle"}),R({className:n.className+"__slider",leftBtn:{className:n.className+"__slider-left",textContent:"<",eventListener:e=>{w.size>3&&(w.size-=1,a(n.className+"__slider-current",String(w.size)))}},currentBtn:{className:n.className+"__slider-current",textContent:"3",eventListener:e=>{}},rightBtn:{className:n.className+"__slider-right",textContent:">",eventListener:e=>{w.size<8&&(w.size+=1,a(n.className+"__slider-current",String(w.size)))}}}),e({className:n.className+"__play-btn",textContent:"Play",eventListener:e=>{document.body.innerHTML="",w.generate(),document.body.append($(),T({size:w.size,board:w.values}),k(),q(),D())}}),e({className:n.className+"__scoreboard-btn",textContent:"Scoreboard",eventListener:e=>{}}),e({className:n.className+"__guide-btn",textContent:"Guide",eventListener:e=>{}})]})),n},D=()=>{const e=document.createElement("div");return e.className="blockout",e},$=()=>{const e=document.createElement("audio");return e.className="sound",e.src="./src/sounds/move_sound.mp3",e},R=t=>{const s=document.createElement("div");s.className=t.className;const a=e(t.leftBtn),n=e(t.currentBtn),o=e(t.rightBtn);return s.append(a,n,o),s};document.body.append(H())})()})();
//# sourceMappingURL=bundle.js.map